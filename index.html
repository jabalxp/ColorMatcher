<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Matcher Pro - Ultimate Edition V2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Merriweather:wght@300;700&family=Fira+Code:wght@400&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <style id="dynamic-styles"></style>

    <style>
        :root {
            --color-0: #ffffff;
            --color-1: #e0e0e0;
            --color-2: #cccccc;
            --color-3: #aaaaaa;
            --color-4: #888888;
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            overflow: hidden;
            background-color: #f0f0f0;
            transition: filter 0.3s ease;
        }

        /* --- FILTROS DE DALTONISMO (SVG) --- */
        .filter-protanopia { filter: url('#protanopia-filter'); }
        .filter-deuteranopia { filter: url('#deuteranopia-filter'); }
        .filter-tritanopia { filter: url('#tritanopia-filter'); }
        .filter-achromatopsia { filter: url('#achromatopsia-filter'); }

        /* --- UI GERAL --- */
        nav {
            height: 60px;
            background: white;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 50;
            position: relative;
        }

        .view-container {
            height: calc(100vh - 60px);
            position: relative;
            display: none;
            overflow-y: auto;
        }
        .view-container.active {
            display: flex;
        }

        /* --- PALETA VIEW --- */
        .col {
            height: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            transition: background-color 0.4s cubic-bezier(0.22, 1, 0.36, 1);
        }

        .col-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            transition: transform 0.2s ease;
            z-index: 10;
        }
        
        .role-badge {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            opacity: 0.9;
            margin-bottom: 2px;
            background: rgba(0,0,0,0.1);
            pointer-events: none;
        }
        
        .meta-badges {
            display: flex;
            gap: 5px;
            margin-bottom: 5px;
        }

        .light-text .role-badge { background: rgba(255,255,255,0.4); color: black; }
        .dark-text .role-badge { background: rgba(0,0,0,0.3); color: white; }

        .col-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.2s ease;
        }

        .col:hover .col-actions, .col.locked .col-actions {
            opacity: 1;
            transform: translateY(0);
        }

        .icon-btn {
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .icon-btn:hover { background: rgba(0,0,0,0.1); }
        .light-text .icon-btn:hover { background: rgba(255,255,255,0.3); }

        .hex-text {
            font-size: 1.5rem;
            font-weight: 800;
            text-transform: uppercase;
            cursor: pointer;
            letter-spacing: -1px;
            user-select: none;
            padding: 5px 10px;
            border-radius: 6px;
            transition: background 0.2s;
        }
        .hex-text:hover { background: rgba(0,0,0,0.1); }
        .light-text .hex-text:hover { background: rgba(255,255,255,0.2); }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            backdrop-filter: blur(4px);
        }
        .modal-overlay.open {
            opacity: 1;
            pointer-events: all;
        }
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            transform: scale(0.95);
            transition: transform 0.2s ease;
            max-height: 85vh;
            overflow-y: auto;
        }
        .modal-content.large { max-width: 900px; }
        .modal-overlay.open .modal-content {
            transform: scale(1);
        }
        
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            white-space: pre-wrap;
            margin: 15px 0;
            font-size: 0.9rem;
            overflow-x: auto;
        }

        /* --- GENERATOR VIEWS --- */
        .generator-container {
            width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;
            background: #f8f9fa; padding: 20px;
        }
        .generator-card {
            background: white; padding: 30px; border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08); display: flex; flex-direction: row;
            gap: 40px; max-width: 1000px; width: 100%; align-items: flex-start;
        }
        .preview-area {
            flex: 1; height: 400px; background-color: #ffffff;
            background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 20px 20px; border-radius: 12px; border: 1px solid #e5e7eb;
            display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden;
        }
        .controls-area { width: 350px; display: flex; flex-direction: column; gap: 20px; }
        .control-group { display: flex; flex-direction: column; gap: 8px; }
        .control-group label { font-size: 0.8rem; font-weight: 700; color: #4b5563; text-transform: uppercase; display: flex; justify-content: space-between; }
        
        input[type="range"] {
            width: 100%; height: 6px; background: #e5e7eb; border-radius: 5px; appearance: none; cursor: pointer;
        }
        input[type="range"]::-webkit-slider-thumb {
            appearance: none; width: 18px; height: 18px; background: #4f46e5; border-radius: 50%; cursor: pointer; transition: transform 0.1s;
        }
        input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.1); }

        .preview-box { width: 150px; height: 150px; background: #4f46e5; border-radius: 12px; transition: all 0.2s ease; }
        
        /* --- GRADIENT VIEW --- */
        #gradient-preview {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }
        .gradient-controls {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            gap: 12px;
            min-width: 160px;
        }
        
        .color-dot { width: 30px; height: 30px; border-radius: 50%; border: 2px solid #ddd; cursor: pointer; position: relative; overflow: hidden; }
        .color-dot input { position: absolute; top: -10px; left: -10px; width: 200%; height: 200%; cursor: pointer; opacity: 0; }
        .color-picker-row { display: flex; align-items: center; justify-content: space-between; gap: 10px; }

        .nav-btn {
            padding: 6px 16px; border-radius: 8px; font-size: 0.85rem; font-weight: 600; transition: all 0.2s; cursor: pointer;
            white-space: nowrap;
        }
        .nav-btn.active { background-color: white; color: #111827; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .nav-btn.inactive { color: #6b7280; }
        .nav-btn.inactive:hover { color: #111827; background-color: rgba(0,0,0,0.05); }

        .msg-toast {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px);
            background: #111; color: white; padding: 12px 24px; border-radius: 50px; font-weight: 600;
            opacity: 0; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 100;
        }
        .msg-toast.active { opacity: 1; transform: translateX(-50%) translateY(0); }

        /* Styles for UI Generator Preview */
        #ui-preview-container {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            background-color: #f9fafb;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            overflow-y: auto;
        }

        /* Menu de Vision/Acessibilidade */
        .vision-menu {
            position: absolute;
            top: 65px;
            right: 20px;
            background: white;
            padding: 10px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            display: none;
            flex-direction: column;
            gap: 5px;
            z-index: 60;
            width: 200px;
        }
        .vision-menu.open { display: flex; }
        .vision-btn {
            text-align: left;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9rem;
            color: #374151;
            transition: bg 0.2s;
        }
        .vision-btn:hover { background: #f3f4f6; }
        .vision-btn.active { background: #e0e7ff; color: #4338ca; font-weight: 600; }

        /* --- SCROLLBAR CUSTOMIZER --- */
        #scrollbar-target {
            width: 100%;
            height: 100%;
            overflow-y: scroll;
            padding: 20px;
            background: white;
            color: #333;
            border-radius: 8px;
            position: relative;
        }

        /* --- CONTEXT MENU STYLES --- */
        .context-menu-base {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            padding: 8px 0;
            min-width: 200px;
            display: flex;
            flex-direction: column;
            border: 1px solid #eee;
        }
        .context-item {
            padding: 8px 16px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.15s;
        }
        .context-divider { height: 1px; background: #eee; margin: 4px 0; opacity: 0.5; }

        .custom-context-menu {
            position: absolute;
            display: none;
            z-index: 999;
            animation: fadeIn 0.1s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        /* --- TYPOGRAPHY PREVIEW --- */
        #typo-preview-area {
            overflow-y: auto; padding: 40px;
            display: flex; flex-direction: column; gap: 20px; align-items: flex-start; justify-content: flex-start;
        }

        /* --- TRANSFORM PREVIEW --- */
        .transform-box-wrapper {
            width: 200px; height: 200px; border: 2px dashed #e5e7eb; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
        }
        #transform-box {
            width: 100%; height: 100%;
            background: linear-gradient(135deg, #6366f1, #a855f7);
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            color: white; font-weight: bold; cursor: pointer;
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }

        @media(max-width: 1024px) {
            .generator-card { flex-direction: column; height: auto; align-items: stretch; }
            .preview-area { height: 300px; }
            .controls-area { width: 100%; }
        }

        @media(max-width: 768px) {
            #palette-view { flex-direction: column; }
            .col-actions { flex-direction: row; opacity: 1; transform: translateY(0); }
            .col { flex-direction: row; justify-content: space-between; padding: 0 20px; }
            .col-info { flex-direction: row-reverse; width: 100%; justify-content: space-between; }
            .meta-badges { margin-bottom: 0; margin-right: 10px; }
            nav { overflow-x: auto; gap: 10px; }
            .nav-group { min-width: max-content; }
        }
    </style>
</head>
<body>

    <svg style="display: none;">
        <defs>
            <filter id="protanopia-filter"><feColorMatrix type="matrix" values="0.567, 0.433, 0, 0, 0 0.558, 0.442, 0, 0, 0 0, 0.242, 0.758, 0, 0 0, 0, 0, 1, 0"/></filter>
            <filter id="deuteranopia-filter"><feColorMatrix type="matrix" values="0.625, 0.375, 0, 0, 0 0.7, 0.3, 0, 0, 0 0, 0.3, 0.7, 0, 0 0, 0, 0, 1, 0"/></filter>
            <filter id="tritanopia-filter"><feColorMatrix type="matrix" values="0.95, 0.05, 0, 0, 0 0, 0.433, 0.567, 0, 0 0, 0.475, 0.525, 0, 0 0, 0, 0, 1, 0"/></filter>
            <filter id="achromatopsia-filter"><feColorMatrix type="matrix" values="0.299, 0.587, 0.114, 0, 0 0.299, 0.587, 0.114, 0, 0 0.299, 0.587, 0.114, 0, 0 0, 0, 0, 1, 0"/></filter>
        </defs>
    </svg>

    <div id="custom-context-menu" class="custom-context-menu context-menu-base">
        <div class="context-item" onclick="copyScrollbarCSS()">
            <i data-lucide="copy" width="16"></i> Copiar CSS
        </div>
        <div class="context-item" onclick="randomizeScrollbar()">
            <i data-lucide="shuffle" width="16"></i> Aleatório
        </div>
        <div class="context-divider"></div>
        <div class="context-item" onclick="resetScrollbar()">
            <i data-lucide="rotate-ccw" width="16"></i> Resetar
        </div>
    </div>

    <nav>
        <div class="flex items-center gap-2 mr-4">
            <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-pink-500 rounded-lg shadow-sm flex-shrink-0"></div>
            <h1 class="font-bold text-xl tracking-tight text-gray-800 hidden lg:block">Color Matcher Pro</h1>
        </div>

        <div class="flex bg-gray-100 p-1 rounded-lg nav-group mx-auto">
            <button onclick="switchView('palette')" id="btn-palette" class="nav-btn active">Paleta</button>
            <button onclick="switchView('gradient')" id="btn-gradient" class="nav-btn inactive">Gradiente</button>
            <button onclick="switchView('shadow')" id="btn-shadow" class="nav-btn inactive">Sombra</button>
            <button onclick="switchView('border')" id="btn-border" class="nav-btn inactive">Borda</button>
            <button onclick="switchView('typography')" id="btn-typography" class="nav-btn inactive">Tipografia</button>
            <button onclick="switchView('transform')" id="btn-transform" class="nav-btn inactive">Transform</button>
            <button onclick="switchView('scrollbar')" id="btn-scrollbar" class="nav-btn inactive">Scroll</button>
            <button onclick="switchView('menu')" id="btn-menu" class="nav-btn inactive">Menu</button>
        </div>

        <div class="flex gap-2 items-center ml-4">
            <div class="relative">
                <button onclick="toggleVisionMenu()" class="flex items-center justify-center w-8 h-8 text-gray-600 hover:bg-gray-100 rounded-md transition" title="Simulador de Visão">
                    <i data-lucide="eye" width="18"></i>
                </button>
                <div id="vision-menu" class="vision-menu">
                    <button onclick="setVisionMode('normal')" class="vision-btn active">Normal</button>
                    <button onclick="setVisionMode('protanopia')" class="vision-btn">Protanopia (Sem Vermelho)</button>
                    <button onclick="setVisionMode('deuteranopia')" class="vision-btn">Deuteranopia (Sem Verde)</button>
                    <button onclick="setVisionMode('tritanopia')" class="vision-btn">Tritanopia (Sem Azul)</button>
                    <button onclick="setVisionMode('achromatopsia')" class="vision-btn">Monocromático</button>
                </div>
            </div>

            <div class="h-6 w-px bg-gray-200 mx-1"></div>

            <button onclick="openUIModal()" class="flex items-center gap-1 px-3 py-1.5 text-sm font-semibold text-white bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 rounded-md transition shadow-sm animate-pulse-slow" title="Gerar Interface">
                <i data-lucide="layout-template" width="16"></i>
                <span class="hidden md:inline">UI</span>
            </button>

            <button onclick="openAIModal()" class="flex items-center gap-1 px-3 py-1.5 text-sm font-semibold text-white bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 rounded-md transition shadow-sm animate-pulse-slow" title="Gerar Cores Inteligentes">
                <i data-lucide="sparkles" width="16"></i>
                <span class="hidden md:inline">Smart</span>
            </button>

            <button onclick="analyzePalette()" class="flex items-center gap-1 px-3 py-1.5 text-sm font-semibold text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition" title="Análise">
                <i data-lucide="scan-eye" width="16"></i>
            </button>

            <button onclick="invertPalette()" class="flex items-center gap-1 px-3 py-1.5 text-sm font-semibold text-gray-600 hover:bg-gray-100 rounded-md transition border border-gray-200" title="Inverter (Claro/Escuro)">
                <i data-lucide="sun-moon" width="16"></i>
            </button>

             <button onclick="openCSSModal()" class="flex items-center gap-1 px-3 py-1.5 text-sm font-semibold text-gray-600 hover:bg-gray-100 rounded-md transition border border-gray-200" title="Ver CSS">
                <i data-lucide="code" width="16"></i>
            </button>
        </div>
    </nav>

    <div id="palette-view" class="view-container active w-full"></div>

    <div id="gradient-view" class="view-container w-full">
        <div id="gradient-preview">
            <div class="gradient-controls">
                <h3 class="font-bold text-gray-800 text-lg">Gerador de Gradiente</h3>
                
                <div class="color-picker-row">
                    <span class="font-mono text-gray-500 text-sm w-20" id="grad-hex-1">#FFFFFF</span>
                    <div class="color-dot" id="dot-1" style="background: #fff;">
                        <input type="color" id="input-grad-1" oninput="updateGradientFromInput()">
                    </div>
                </div>

                <div class="flex justify-center gap-2">
                    <button onclick="randomGradient()" class="p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition">
                        <i data-lucide="shuffle" class="w-4 h-4 text-gray-600"></i>
                    </button>
                </div>

                <div class="color-picker-row">
                    <span class="font-mono text-gray-500 text-sm w-20" id="grad-hex-2">#000000</span>
                    <div class="color-dot" id="dot-2" style="background: #000;">
                        <input type="color" id="input-grad-2" oninput="updateGradientFromInput()">
                    </div>
                </div>

                <div class="mt-2">
                    <label class="text-xs font-bold text-gray-400 uppercase">Ângulo</label>
                    <div class="flex items-center gap-2">
                        <input type="range" id="grad-angle" min="0" max="360" value="90" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" oninput="updateGradientFromInput()">
                        <span class="text-xs font-mono w-8" id="angle-val">90°</span>
                    </div>
                </div>

                <button onclick="copyGradientCSS()" class="mt-2 w-full bg-black text-white py-3 rounded-lg font-bold hover:bg-gray-800 transition active:scale-95">
                    Copiar CSS
                </button>
            </div>
        </div>
    </div>

    <div id="shadow-view" class="view-container">
        <div class="generator-container">
            <div class="generator-card">
                <div class="preview-area">
                    <div id="shadow-preview-box" class="preview-box bg-white"></div>
                </div>
                <div class="controls-area">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Sombra (Box Shadow)</h3>

                    <div class="control-group">
                        <label>Horizontal (X): <span id="shadow-x-val">10px</span></label>
                        <input type="range" id="shadow-x" min="-100" max="100" value="10" oninput="updateShadowUI()">
                    </div>
                    <div class="control-group">
                        <label>Vertical (Y): <span id="shadow-y-val">10px</span></label>
                        <input type="range" id="shadow-y" min="-100" max="100" value="10" oninput="updateShadowUI()">
                    </div>
                    <div class="control-group">
                        <label>Blur (Desfoque): <span id="shadow-blur-val">20px</span></label>
                        <input type="range" id="shadow-blur" min="0" max="100" value="20" oninput="updateShadowUI()">
                    </div>
                    <div class="control-group">
                        <label>Spread (Propagação): <span id="shadow-spread-val">0px</span></label>
                        <input type="range" id="shadow-spread" min="-50" max="50" value="0" oninput="updateShadowUI()">
                    </div>
                    <div class="control-group">
                        <label>Opacidade: <span id="shadow-opacity-val">0.2</span></label>
                        <input type="range" id="shadow-opacity" min="0" max="1" step="0.01" value="0.2" oninput="updateShadowUI()">
                    </div>
                    
                    <div class="flex items-center justify-between mt-2">
                        <label class="flex items-center gap-2 text-sm font-bold text-gray-600 cursor-pointer">
                            <input type="checkbox" id="shadow-inset" class="rounded text-indigo-600 focus:ring-indigo-500" onchange="updateShadowUI()">
                            Sombra Interna (Inset)
                        </label>
                        <div class="color-dot" id="shadow-color-dot" style="background: #000;">
                            <input type="color" id="shadow-color" value="#000000" oninput="updateShadowUI()">
                        </div>
                    </div>

                    <button onclick="copyShadowCSS()" class="mt-auto w-full bg-black text-white py-3 rounded-lg font-bold hover:bg-gray-800 transition active:scale-95">
                        Copiar CSS
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="border-view" class="view-container">
        <div class="generator-container">
            <div class="generator-card">
                <div class="preview-area">
                    <div id="border-preview-box" class="preview-box bg-transparent w-[200px] h-[200px] flex items-center justify-center text-gray-400 font-bold border-gray-300 border-2">
                        Preview
                    </div>
                </div>
                <div class="controls-area">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Borda & Radius</h3>
                    <div class="control-group">
                        <label>Todas as Bordas (Radius): <span id="border-radius-val">12px</span></label>
                        <input type="range" id="border-radius" min="0" max="100" value="12" oninput="updateBorderUI()">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="control-group"><label>Sup. Esq.</label><input type="range" id="br-tl" min="0" max="100" value="12" oninput="updateBorderUI(true)"></div>
                        <div class="control-group"><label>Sup. Dir.</label><input type="range" id="br-tr" min="0" max="100" value="12" oninput="updateBorderUI(true)"></div>
                        <div class="control-group"><label>Inf. Esq.</label><input type="range" id="br-bl" min="0" max="100" value="12" oninput="updateBorderUI(true)"></div>
                        <div class="control-group"><label>Inf. Dir.</label><input type="range" id="br-br" min="0" max="100" value="12" oninput="updateBorderUI(true)"></div>
                    </div>
                    <div class="h-px bg-gray-200 my-2"></div>
                    <div class="control-group">
                        <label>Espessura: <span id="border-width-val">2px</span></label>
                        <input type="range" id="border-width" min="0" max="20" value="2" oninput="updateBorderUI()">
                    </div>
                    <div class="flex items-center gap-2 mt-2">
                        <select id="border-style" class="flex-1 p-2 border border-gray-300 rounded-md text-sm" onchange="updateBorderUI()">
                            <option value="solid">Solid</option>
                            <option value="dashed">Dashed</option>
                            <option value="dotted">Dotted</option>
                            <option value="double">Double</option>
                        </select>
                        <div class="color-dot" id="border-color-dot" style="background: #4f46e5;">
                            <input type="color" id="border-color" value="#4f46e5" oninput="updateBorderUI()">
                        </div>
                    </div>
                    <button onclick="copyBorderCSS()" class="mt-auto w-full bg-black text-white py-3 rounded-lg font-bold hover:bg-gray-800 transition active:scale-95">
                        Copiar CSS
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="typography-view" class="view-container">
        <div class="generator-container">
            <div class="generator-card">
                <div class="preview-area" id="typo-preview-area">
                    <h1 id="typo-h1" class="text-4xl text-gray-900 mb-2">A Raposa Rápida</h1>
                    <p id="typo-p" class="text-gray-600">A rápida raposa marrom pula sobre o cão preguiçoso. A tipografia define o ritmo da leitura e a personalidade do texto. Ajuste os controles ao lado para encontrar o par perfeito.</p>
                </div>
                <div class="controls-area">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Tipografia</h3>

                    <div class="mb-4">
                        <h4 class="font-bold text-xs text-indigo-600 uppercase mb-2">Título (H1)</h4>
                        <div class="control-group mb-2">
                            <select id="typo-font-h1" class="w-full p-2 border rounded text-sm" onchange="updateTypographyUI()">
                                <option value="'Inter', sans-serif">Inter (Sans)</option>
                                <option value="'Merriweather', serif">Merriweather (Serif)</option>
                                <option value="'Fira Code', monospace">Fira Code (Mono)</option>
                                <option value="Arial, sans-serif">Arial</option>
                                <option value="Times New Roman, serif">Times New Roman</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Tamanho: <span id="typo-size-h1-val">36px</span></label>
                            <input type="range" id="typo-size-h1" min="12" max="72" value="36" oninput="updateTypographyUI()">
                        </div>
                        <div class="control-group">
                            <label>Peso: <span id="typo-weight-h1-val">700</span></label>
                            <input type="range" id="typo-weight-h1" min="100" max="900" step="100" value="700" oninput="updateTypographyUI()">
                        </div>
                         <div class="control-group">
                            <label>Espaçamento: <span id="typo-space-h1-val">0px</span></label>
                            <input type="range" id="typo-space-h1" min="-2" max="10" step="0.5" value="0" oninput="updateTypographyUI()">
                        </div>
                    </div>

                    <div class="h-px bg-gray-200 my-2"></div>

                    <div class="mb-4">
                        <h4 class="font-bold text-xs text-indigo-600 uppercase mb-2">Corpo (P)</h4>
                        <div class="control-group mb-2">
                            <select id="typo-font-p" class="w-full p-2 border rounded text-sm" onchange="updateTypographyUI()">
                                <option value="'Inter', sans-serif">Inter (Sans)</option>
                                <option value="'Merriweather', serif">Merriweather (Serif)</option>
                                <option value="'Fira Code', monospace">Fira Code (Mono)</option>
                                <option value="Arial, sans-serif">Arial</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Tamanho: <span id="typo-size-p-val">16px</span></label>
                            <input type="range" id="typo-size-p" min="10" max="32" value="16" oninput="updateTypographyUI()">
                        </div>
                         <div class="control-group">
                            <label>Linha (Height): <span id="typo-line-p-val">1.5</span></label>
                            <input type="range" id="typo-line-p" min="1" max="2.5" step="0.1" value="1.5" oninput="updateTypographyUI()">
                        </div>
                    </div>

                    <button onclick="copyTypographyCSS()" class="mt-auto w-full bg-black text-white py-3 rounded-lg font-bold hover:bg-gray-800 transition active:scale-95">
                        Copiar CSS
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="transform-view" class="view-container">
        <div class="generator-container">
            <div class="generator-card">
                <div class="preview-area">
                    <div class="transform-box-wrapper">
                        <div id="transform-box">Passe o Mouse</div>
                    </div>
                </div>
                <div class="controls-area">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Transform & Transition</h3>
                    <p class="text-xs text-gray-500 mb-4">Configure o estado de "Hover" (ao passar o mouse).</p>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="control-group">
                            <label>Rotate (Deg)</label>
                            <input type="range" id="trans-rotate" min="-180" max="180" value="0" oninput="updateTransformUI()">
                        </div>
                        <div class="control-group">
                            <label>Scale (Zoom)</label>
                            <input type="range" id="trans-scale" min="0.5" max="2" step="0.1" value="1" oninput="updateTransformUI()">
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4 mt-2">
                        <div class="control-group">
                            <label>Translate X</label>
                            <input type="range" id="trans-x" min="-100" max="100" value="0" oninput="updateTransformUI()">
                        </div>
                        <div class="control-group">
                            <label>Translate Y</label>
                            <input type="range" id="trans-y" min="-100" max="100" value="0" oninput="updateTransformUI()">
                        </div>
                    </div>

                    <div class="control-group mt-2">
                        <label>Skew X (Inclinar)</label>
                        <input type="range" id="trans-skew" min="-45" max="45" value="0" oninput="updateTransformUI()">
                    </div>

                    <div class="h-px bg-gray-200 my-4"></div>

                    <h4 class="font-bold text-xs text-indigo-600 uppercase mb-2">Transition (Animação)</h4>
                    <div class="control-group">
                        <label>Duração: <span id="trans-dur-val">0.3s</span></label>
                        <input type="range" id="trans-dur" min="0.1" max="2" step="0.1" value="0.3" oninput="updateTransformUI()">
                    </div>
                     <div class="control-group">
                        <label>Timing Function</label>
                        <select id="trans-timing" class="w-full p-2 border rounded text-sm" onchange="updateTransformUI()">
                            <option value="ease">Ease</option>
                            <option value="linear">Linear</option>
                            <option value="ease-in">Ease-In</option>
                            <option value="ease-out">Ease-Out</option>
                            <option value="ease-in-out">Ease-In-Out</option>
                        </select>
                    </div>

                    <button onclick="copyTransformCSS()" class="mt-auto w-full bg-black text-white py-3 rounded-lg font-bold hover:bg-gray-800 transition active:scale-95">
                        Copiar CSS
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="scrollbar-view" class="view-container">
        <div class="generator-container">
            <div class="generator-card">
                <div class="preview-area" id="scrollbar-preview-area">
                    <div id="scrollbar-target">
                        <h2 class="text-2xl font-bold mb-4">Preview do Scrollbar</h2>
                        <p class="mb-4 text-gray-500 text-sm italic">Clique com o botão direito aqui para ver o menu personalizado (que você cria na aba 'Menu').</p>
                        <p class="mb-4">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                        <p class="mb-4">Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        <p class="mb-4">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                        <p class="mb-4">Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        <p class="mb-4">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                        <p class="mb-4">Fim do conteúdo de exemplo.</p>
                    </div>
                </div>
                <div class="controls-area">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Scrollbar Customizer</h3>
                    <p class="text-xs text-gray-500 mb-4">Customize a barra de rolagem (Webkit).</p>

                    <div class="control-group">
                        <label>Largura: <span id="scroll-width-val">12px</span></label>
                        <input type="range" id="scroll-width" min="4" max="30" value="12" oninput="updateScrollbarUI()">
                    </div>
                    <div class="control-group">
                        <label>Arredondamento: <span id="scroll-radius-val">10px</span></label>
                        <input type="range" id="scroll-radius" min="0" max="20" value="10" oninput="updateScrollbarUI()">
                    </div>
                    <div class="h-px bg-gray-200 my-2"></div>
                    <div class="control-group">
                        <label>Cor da Barra (Thumb)</label>
                        <div class="flex items-center gap-2">
                            <div class="color-dot" id="scroll-thumb-dot" style="background: #4f46e5;">
                                <input type="color" id="scroll-thumb" value="#4f46e5" oninput="updateScrollbarUI()">
                            </div>
                            <span class="text-sm text-gray-600 font-mono" id="scroll-thumb-hex">#4F46E5</span>
                        </div>
                    </div>
                    <div class="control-group">
                        <label>Cor do Fundo (Track)</label>
                        <div class="flex items-center gap-2">
                            <div class="color-dot" id="scroll-track-dot" style="background: #f1f1f1;">
                                <input type="color" id="scroll-track" value="#f1f1f1" oninput="updateScrollbarUI()">
                            </div>
                            <span class="text-sm text-gray-600 font-mono" id="scroll-track-hex">#F1F1F1</span>
                        </div>
                    </div>

                    <button onclick="copyScrollbarCSS()" class="mt-auto w-full bg-black text-white py-3 rounded-lg font-bold hover:bg-gray-800 transition active:scale-95">
                        Copiar CSS
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="menu-view" class="view-container">
        <div class="generator-container">
            <div class="generator-card">
                <div class="preview-area relative bg-gray-100">
                    <div id="menu-preview-mock" class="context-menu-base absolute" style="top: 50%; left: 50%; transform: translate(-50%, -50%);">
                        <div class="context-item">
                            <i data-lucide="scissors" width="16"></i> Recortar
                        </div>
                        <div class="context-item">
                            <i data-lucide="copy" width="16"></i> Copiar
                        </div>
                        <div class="context-item">
                            <i data-lucide="clipboard" width="16"></i> Colar
                        </div>
                        <div class="context-divider"></div>
                        <div class="context-item">
                            <i data-lucide="trash-2" width="16"></i> Excluir
                        </div>
                    </div>
                </div>
                <div class="controls-area">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Menu de Contexto</h3>
                    <p class="text-xs text-gray-500 mb-4">Design do botão direito do mouse.</p>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="control-group">
                            <label>Fundo</label>
                            <div class="flex gap-2 items-center">
                                <div class="color-dot" id="menu-bg-dot" style="background: #ffffff;"><input type="color" id="menu-bg" value="#ffffff" oninput="updateMenuUI()"></div>
                            </div>
                        </div>
                        <div class="control-group">
                            <label>Texto</label>
                            <div class="flex gap-2 items-center">
                                <div class="color-dot" id="menu-text-dot" style="background: #333333;"><input type="color" id="menu-text" value="#333333" oninput="updateMenuUI()"></div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4 mt-2">
                        <div class="control-group">
                            <label>Hover (Fundo)</label>
                            <div class="flex gap-2 items-center">
                                <div class="color-dot" id="menu-hover-bg-dot" style="background: #f3f4f6;"><input type="color" id="menu-hover-bg" value="#f3f4f6" oninput="updateMenuUI()"></div>
                            </div>
                        </div>
                        <div class="control-group">
                            <label>Hover (Texto)</label>
                            <div class="flex gap-2 items-center">
                                <div class="color-dot" id="menu-hover-text-dot" style="background: #000000;"><input type="color" id="menu-hover-text" value="#000000" oninput="updateMenuUI()"></div>
                            </div>
                        </div>
                    </div>

                    <div class="h-px bg-gray-200 my-4"></div>

                    <div class="control-group">
                        <label>Cor da Borda</label>
                         <div class="flex gap-2 items-center">
                            <div class="color-dot" id="menu-border-col-dot" style="background: #eeeeee;"><input type="color" id="menu-border-col" value="#eeeeee" oninput="updateMenuUI()"></div>
                        </div>
                    </div>
                    <div class="control-group">
                        <label>Arredondamento: <span id="menu-radius-val">8px</span></label>
                        <input type="range" id="menu-radius" min="0" max="20" value="8" oninput="updateMenuUI()">
                    </div>

                    <div class="control-group mt-2">
                         <label class="flex items-center gap-2 text-sm font-bold text-gray-600 cursor-pointer">
                            <input type="checkbox" id="menu-shadow-check" checked class="rounded text-indigo-600 focus:ring-indigo-500" onchange="updateMenuUI()">
                            Ativar Sombra
                        </label>
                    </div>

                    <button onclick="copyMenuCSS()" class="mt-auto w-full bg-black text-white py-3 rounded-lg font-bold hover:bg-gray-800 transition active:scale-95">
                        Copiar CSS
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="css-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-2">
                <h3 class="text-lg font-bold">Código CSS</h3>
                <button onclick="closeCSSModal()" class="p-1 hover:bg-gray-100 rounded"><i data-lucide="x" width="20"></i></button>
            </div>
            <p class="text-sm text-gray-500">Copie e cole isso no seu projeto.</p>
            <div class="code-block" id="css-code-block"></div>
            <button onclick="copyCSSBlock()" class="w-full bg-indigo-600 text-white py-2 rounded font-semibold hover:bg-indigo-700 transition">Copiar Código</button>
        </div>
    </div>

    <div id="ai-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold flex items-center gap-2">
                    <i data-lucide="sparkles" class="text-purple-600"></i>
                    Gerador Smart (Local)
                </h3>
                <button onclick="closeAIModal()" class="p-1 hover:bg-gray-100 rounded"><i data-lucide="x" width="20"></i></button>
            </div>
            <div class="flex border-b border-gray-200 mb-4">
                <button onclick="switchAiTab('text')" id="tab-text" class="flex-1 py-2 text-sm font-semibold text-purple-600 border-b-2 border-purple-600 transition">Texto Mágico</button>
                <button onclick="switchAiTab('image')" id="tab-image" class="flex-1 py-2 text-sm font-semibold text-gray-500 hover:text-purple-600 transition">Extrair de Imagem</button>
            </div>
            <div id="ai-panel-text">
                <p class="text-sm text-gray-500 mb-2">Digite uma palavra-chave (ex: "Fogo", "Floresta", "Tech").</p>
                <textarea id="ai-prompt" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none resize-none" placeholder="Ex: Oceano, Cyberpunk, Café..."></textarea>
                <button onclick="generateLocalTextColors()" id="ai-generate-btn-text" class="w-full mt-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 rounded-lg font-bold hover:opacity-90 transition active:scale-95 flex items-center justify-center gap-2">
                    <span>Gerar Paleta</span>
                </button>
            </div>
            <div id="ai-panel-image" class="hidden">
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 flex flex-col items-center justify-center cursor-pointer hover:bg-gray-50 transition" onclick="document.getElementById('image-upload').click()">
                    <i data-lucide="image-plus" class="w-10 h-10 text-gray-400 mb-2"></i>
                    <p class="text-sm text-gray-500 font-medium text-center">Clique para carregar imagem</p>
                    <input type="file" id="image-upload" class="hidden" accept="image/*" onchange="handleImageUpload(event)">
                </div>
                <div id="image-preview-container" class="hidden mt-4">
                    <img id="image-preview" class="w-full h-32 object-cover rounded-lg shadow-sm" alt="Preview">
                    <canvas id="image-canvas" class="hidden"></canvas>
                    <p class="text-xs text-gray-500 mt-2 text-center">Imagem carregada. Pronto para extrair.</p>
                </div>
                <button onclick="extractColorsFromImage()" id="ai-generate-btn-image" class="w-full mt-4 bg-gray-800 text-white py-3 rounded-lg font-bold hover:opacity-90 transition active:scale-95 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    <span>Extrair Cores</span>
                </button>
            </div>
        </div>
    </div>

    <div id="ui-modal" class="modal-overlay">
        <div class="modal-content large">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold flex items-center gap-2">
                    <i data-lucide="layout-template" class="text-emerald-600"></i>
                    Visualizador de UI (Templates)
                </h3>
                <button onclick="closeUIModal()" class="p-1 hover:bg-gray-100 rounded"><i data-lucide="x" width="20"></i></button>
            </div>
            <p class="text-sm text-gray-500 mb-4">Visualize sua paleta em componentes reais (Geração Instantânea).</p>
            <div class="flex gap-2 mb-4">
                <select id="ui-component-type" class="p-2 border border-gray-300 rounded-md text-sm flex-1">
                    <option value="hero">Hero Section</option>
                    <option value="card">Cartão de Produto</option>
                    <option value="stats">Estatísticas</option>
                    <option value="login">Tela de Login</option>
                </select>
                <button onclick="generateLocalUI()" class="px-4 py-2 bg-emerald-600 text-white rounded-md text-sm font-bold hover:bg-emerald-700 transition">
                    Gerar UI
                </button>
            </div>
            <div id="ui-preview-container">
                <p class="text-gray-400 text-sm p-4 text-center">Selecione um componente e clique em "Gerar UI".</p>
            </div>
        </div>
    </div>

    <div id="analysis-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold flex items-center gap-2">
                    <i data-lucide="scan-eye" class="text-blue-600"></i>
                    Análise da Paleta
                </h3>
                <button onclick="closeAnalysisModal()" class="p-1 hover:bg-gray-100 rounded"><i data-lucide="x" width="20"></i></button>
            </div>
            <div id="analysis-result" class="analysis-content"></div>
        </div>
    </div>

    <div id="toast" class="msg-toast shadow-lg">Cor Copiada!</div>

    <script>
        // --- 1. CONFIGURAÇÃO & ESTADO ---
        let currentView = 'palette';
        let lockedState = [false, false, false, false, false];
        let paletteColors = [];
        let gradientState = { c1: '#4facfe', c2: '#00f2fe', angle: 90 };
        
        const keywordColors = {
            'fogo': { h: 10, s: 90 }, 'vermelho': { h: 0, s: 90 }, 'calor': { h: 20, s: 95 },
            'floresta': { h: 120, s: 60 }, 'verde': { h: 110, s: 70 }, 'natureza': { h: 100, s: 50 },
            'oceano': { h: 210, s: 80 }, 'azul': { h: 220, s: 90 }, 'água': { h: 200, s: 90 },
            'sol': { h: 50, s: 95 }, 'amarelo': { h: 55, s: 90 }, 'luz': { h: 60, s: 100 },
            'roxo': { h: 270, s: 80 }, 'mágica': { h: 280, s: 75 }, 'mistério': { h: 260, s: 60 },
            'terra': { h: 30, s: 50 }, 'madeira': { h: 35, s: 60 }, 'café': { h: 25, s: 40 },
            'tech': { h: 190, s: 90 }, 'cyberpunk': { h: 300, s: 100 }, 'futuro': { h: 180, s: 80 },
            'amor': { h: 340, s: 90 }, 'rosa': { h: 330, s: 85 },
            'escuridão': { h: 0, s: 0, l: 10 }, 'noite': { h: 230, s: 50, l: 20 }
        };

        // --- 2. HELPERS DE COR ---
        function hexToHSL(hex) {
            let r = 0, g = 0, b = 0;
            hex = hex.replace('#', '');
            if (hex.length == 3) {
                r = parseInt(hex[0]+hex[0], 16); g = parseInt(hex[1]+hex[1], 16); b = parseInt(hex[2]+hex[2], 16);
            } else {
                r = parseInt(hex.substring(0,2), 16); g = parseInt(hex.substring(2,4), 16); b = parseInt(hex.substring(4,6), 16);
            }
            r /= 255; g /= 255; b /= 255;
            let cmin = Math.min(r,g,b), cmax = Math.max(r,g,b), delta = cmax - cmin;
            let h = 0, s = 0, l = 0;
            if (delta == 0) h = 0;
            else if (cmax == r) h = ((g - b) / delta) % 6;
            else if (cmax == g) h = (b - r) / delta + 2;
            else h = (r - g) / delta + 4;
            h = Math.round(h * 60);
            if (h < 0) h += 360;
            l = (cmax + cmin) / 2;
            s = delta == 0 ? 0 : delta / (1 - Math.abs(2 * l - 1));
            return { h, s: s * 100, l: l * 100 };
        }

        function HSLToHex(h, s, l) {
            s /= 100; l /= 100;
            let c = (1 - Math.abs(2 * l - 1)) * s,
                x = c * (1 - Math.abs(((h / 60) % 2) - 1)),
                m = l - c / 2,
                r = 0, g = 0, b = 0;
            if (0 <= h && h < 60) { r = c; g = x; b = 0; }
            else if (60 <= h && h < 120) { r = x; g = c; b = 0; }
            else if (120 <= h && h < 180) { r = 0; g = c; b = x; }
            else if (180 <= h && h < 240) { r = 0; g = x; b = c; }
            else if (240 <= h && h < 300) { r = x; g = 0; b = c; }
            else if (300 <= h && h < 360) { r = c; g = 0; b = x; }
            const toHex = (n) => {
                const hex = Math.round((n + m) * 255).toString(16);
                return hex.length === 1 ? '0' + hex : hex;
            };
            return `#${toHex(r)}${toHex(g)}${toHex(b)}`.toUpperCase();
        }

        function getLuminance(hex) {
            const rgb = parseInt(hex.slice(1), 16); 
            const r = (rgb >> 16) & 0xff;
            const g = (rgb >>  8) & 0xff;
            const b = (rgb >>  0) & 0xff;
            const a = [r,g,b].map(v => {
                v /= 255;
                return v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4);
            });
            return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;
        }

        // --- CORE PALETTE LOGIC ---
        function generateHarmoniousPalette(seedH = null, seedS = null) {
            const lockedIndices = lockedState.map((isLocked, idx) => isLocked ? idx : -1).filter(i => i !== -1);
            let baseColorHSL;
            if (lockedIndices.length > 0) {
                baseColorHSL = hexToHSL(paletteColors[lockedIndices[0]]);
            } else if (seedH !== null) {
                baseColorHSL = { h: seedH, s: seedS || 70, l: 50 };
            } else {
                baseColorHSL = { h: Math.floor(Math.random() * 360), s: Math.floor(Math.random() * 40) + 50, l: Math.floor(Math.random() * 40) + 30 };
            }
            const schemes = ['analogous', 'monochromatic', 'triad', 'complementary', 'compound'];
            const scheme = schemes[Math.floor(Math.random() * schemes.length)];
            const newColors = [];
            for (let i = 0; i < 5; i++) {
                if (lockedState[i]) { newColors.push(paletteColors[i]); continue; }
                let h = baseColorHSL.h, s = baseColorHSL.s, l = baseColorHSL.l;
                const offset = (Math.random() * 20 - 10); 
                switch (scheme) {
                    case 'analogous': h = (h + (i * 30) + offset) % 360; break;
                    case 'monochromatic': s = Math.max(10, Math.min(95, s + (Math.random() * 40 - 20))); l = Math.max(10, Math.min(90, l + ((i - 2) * 15))); break;
                    case 'triad': if (i % 3 === 1) h = (h + 120) % 360; if (i % 3 === 2) h = (h + 240) % 360; l = Math.max(20, Math.min(85, l + offset)); break;
                    case 'complementary': if (i > 2) h = (h + 180) % 360; l = Math.random() * 60 + 20; break;
                    default: h = (h + (i * 45)) % 360; s = Math.random() * 50 + 40; l = Math.random() * 60 + 20;
                }
                if (l < 10) l = 15; if (l > 95) l = 92;
                newColors.push(HSLToHex(h, s, l));
            }
            return newColors;
        }

        function assignRoles(colors) {
            const analyzed = colors.map((hex, idx) => ({ hex, lum: getLuminance(hex), idx }));
            const sorted = [...analyzed].sort((a, b) => b.lum - a.lum);
            const roles = new Array(5).fill('');
            roles[sorted[0].idx] = "Fundo";
            roles[sorted[4].idx] = "Texto";
            let maxSat = -1, accentIdx = -1;
            analyzed.forEach(c => {
                if (roles[c.idx] !== '') return;
                const hsl = hexToHSL(c.hex);
                if (hsl.s > maxSat) { maxSat = hsl.s; accentIdx = c.idx; }
            });
            if (accentIdx !== -1) roles[accentIdx] = "Destaque";
            analyzed.forEach(c => { if (roles[c.idx] === '') roles[c.idx] = "Secundária"; });
            return roles;
        }

        // --- PALETTE UI ---
        const paletteContainer = document.getElementById('palette-view');
        function initPalette() {
            paletteContainer.innerHTML = '';
            for(let i=0; i<5; i++){
                const col = document.createElement('div');
                col.className = 'col';
                col.id = `col-${i}`;
                col.innerHTML = `
                    <div class="col-info">
                        <div class="meta-badges">
                             <span class="role-badge" id="role-${i}">...</span>
                        </div>
                        <div class="col-actions">
                            <label class="icon-btn" title="Editar Cor">
                                <i data-lucide="pen-line" width="20"></i>
                                <input type="color" class="absolute opacity-0 w-0 h-0" onchange="updateColManual(${i}, this.value)">
                            </label>
                            <button class="icon-btn" onclick="generateVariants(${i})" title="Ver Gradientes desta cor"><i data-lucide="grid-2x2" width="20"></i></button>
                            <button class="icon-btn lock-btn" onclick="toggleLock(${i})" title="Travar"><i data-lucide="unlock" width="20" class="icon-lock"></i></button>
                        </div>
                        <h2 class="hex-text" onclick="copyText('${i}')">#FFFFFF</h2>
                    </div>`;
                paletteContainer.appendChild(col);
            }
            refreshIcons();
            generatePalette(true);
        }

        function generatePalette(initial = false, seedH = null, seedS = null) {
            const newColors = generateHarmoniousPalette(seedH, seedS);
            const roles = assignRoles(newColors);
            newColors.forEach((color, idx) => updateColUI(idx, color, roles[idx]));
            updateRootVariables(newColors);
        }

        function updateColUI(index, color, role) {
            paletteColors[index] = color;
            const col = document.getElementById(`col-${index}`);
            const text = col.querySelector('.hex-text');
            const roleBadge = document.getElementById(`role-${index}`);
            col.style.backgroundColor = color;
            text.textContent = color;
            if(role) roleBadge.textContent = role;
            const lum = getLuminance(color);
            if(lum < 0.5) {
                col.classList.remove('light-text'); col.classList.add('dark-text'); col.style.color = '#FFFFFF';
            } else {
                col.classList.remove('dark-text'); col.classList.add('light-text'); col.style.color = '#000000';
            }
        }

        function updateRootVariables(colors) {
            const root = document.documentElement;
            colors.forEach((color, idx) => root.style.setProperty(`--color-${idx}`, color));
            updateCSSModalContent(colors);
        }

        function updateCSSModalContent(text = null) {
            const block = document.getElementById('css-code-block');
            if (text && typeof text === 'string') {
                block.textContent = text;
            } else {
                let css = ":root {\n";
                paletteColors.forEach((c, i) => css += `  --color-${i}: ${c};\n`);
                css += "}";
                block.textContent = css;
            }
        }

        function toggleLock(index) {
            lockedState[index] = !lockedState[index];
            const col = document.getElementById(`col-${index}`);
            const icon = col.querySelector('.icon-lock');
            if(lockedState[index]){ col.classList.add('locked'); icon.setAttribute('data-lucide', 'lock'); }
            else { col.classList.remove('locked'); icon.setAttribute('data-lucide', 'unlock'); }
            refreshIcons();
        }

        function updateColManual(index, val) {
            paletteColors[index] = val.toUpperCase();
            const roles = assignRoles(paletteColors);
            paletteColors.forEach((c, i) => updateColUI(i, c, roles[i]));
            updateRootVariables(paletteColors);
            if(!lockedState[index]) toggleLock(index);
        }

        function invertPalette() {
            const newColors = paletteColors.map((hex) => {
                const hsl = hexToHSL(hex);
                return HSLToHex(hsl.h, hsl.s, 100 - hsl.l);
            });
            const roles = assignRoles(newColors);
            newColors.forEach((color, idx) => updateColUI(idx, color, roles[idx]));
            updateRootVariables(newColors);
            showToast("Tema invertido!");
        }

        // --- SMART GENERATOR ---
        function generateLocalTextColors() {
            const prompt = document.getElementById('ai-prompt').value.toLowerCase().trim();
            if(!prompt) return;
            let seedH = null; let seedS = null;
            for (const key in keywordColors) { if (prompt.includes(key)) { seedH = keywordColors[key].h; seedS = keywordColors[key].s; break; } }
            if (seedH === null) {
                let hash = 0; for (let i = 0; i < prompt.length; i++) hash = prompt.charCodeAt(i) + ((hash << 5) - hash);
                seedH = Math.abs(hash % 360); seedS = 65;
            }
            generatePalette(false, seedH, seedS);
            closeAIModal();
            showToast(`Paleta gerada para "${prompt}"`);
        }

        // --- UI UTILS ---
        function switchView(viewName) {
            currentView = viewName;
            document.querySelectorAll('.view-container').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(btn => { btn.classList.remove('active'); btn.classList.add('inactive'); });
            document.getElementById(`${viewName}-view`).classList.add('active');
            const activeBtn = document.getElementById(`btn-${viewName}`);
            if(activeBtn) { activeBtn.classList.remove('inactive'); activeBtn.classList.add('active'); }
            
            if(viewName === 'shadow') updateShadowUI();
            if(viewName === 'border') updateBorderUI();
            if(viewName === 'scrollbar') updateScrollbarUI();
            if(viewName === 'menu') updateMenuUI();
            if(viewName === 'typography') updateTypographyUI();
            if(viewName === 'transform') updateTransformUI();
        }

        function copyToClipboard(text, successMessage) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed'; textarea.style.left = '-9999px';
            document.body.appendChild(textarea);
            textarea.select();
            try { document.execCommand('copy'); showToast(successMessage || "Copiado!"); } catch (err) { showToast("Erro ao copiar."); }
            document.body.removeChild(textarea);
        }

        function copyText(index) { copyToClipboard(paletteColors[index], "Cor Copiada!"); }
        function showToast(msg) {
            const t = document.getElementById('toast'); t.textContent = msg; t.classList.add('active');
            setTimeout(() => t.classList.remove('active'), 2000);
        }
        function refreshIcons() { lucide.createIcons(); }

        // --- SHADOW & BORDER ---
        function updateShadowUI() {
            const x = document.getElementById('shadow-x').value;
            const y = document.getElementById('shadow-y').value;
            const blur = document.getElementById('shadow-blur').value;
            const spread = document.getElementById('shadow-spread').value;
            const color = document.getElementById('shadow-color').value;
            const opacity = document.getElementById('shadow-opacity').value;
            const inset = document.getElementById('shadow-inset').checked;
            document.getElementById('shadow-x-val').innerText = x + 'px';
            document.getElementById('shadow-y-val').innerText = y + 'px';
            document.getElementById('shadow-blur-val').innerText = blur + 'px';
            document.getElementById('shadow-spread-val').innerText = spread + 'px';
            document.getElementById('shadow-opacity-val').innerText = opacity;
            document.getElementById('shadow-color-dot').style.background = color;
            const r = parseInt(color.substr(1,2), 16);
            const g = parseInt(color.substr(3,2), 16);
            const b = parseInt(color.substr(5,2), 16);
            const css = `${inset ? 'inset ' : ''}${x}px ${y}px ${blur}px ${spread}px rgba(${r}, ${g}, ${b}, ${opacity})`;
            document.getElementById('shadow-preview-box').style.boxShadow = css;
        }
        function copyShadowCSS() { copyToClipboard(`box-shadow: ${document.getElementById('shadow-preview-box').style.boxShadow};`, "CSS de Sombra Copiado!"); }

        function updateBorderUI(individual = false) {
            const width = document.getElementById('border-width').value;
            const color = document.getElementById('border-color').value;
            const style = document.getElementById('border-style').value;
            const radiusAll = document.getElementById('border-radius').value;
            const box = document.getElementById('border-preview-box');
            document.getElementById('border-width-val').innerText = width + 'px';
            document.getElementById('border-color-dot').style.background = color;
            box.style.borderWidth = width + 'px'; box.style.borderColor = color; box.style.borderStyle = style;
            if (!individual) {
                document.getElementById('br-tl').value = radiusAll; document.getElementById('br-tr').value = radiusAll;
                document.getElementById('br-bl').value = radiusAll; document.getElementById('br-br').value = radiusAll;
                document.getElementById('border-radius-val').innerText = radiusAll + 'px';
                box.style.borderRadius = radiusAll + 'px';
            } else {
                box.style.borderTopLeftRadius = document.getElementById('br-tl').value + 'px';
                box.style.borderTopRightRadius = document.getElementById('br-tr').value + 'px';
                box.style.borderBottomLeftRadius = document.getElementById('br-bl').value + 'px';
                box.style.borderBottomRightRadius = document.getElementById('br-br').value + 'px';
                document.getElementById('border-radius-val').innerText = 'Custom';
            }
        }
        function copyBorderCSS() { 
            const box = document.getElementById('border-preview-box');
            copyToClipboard(`border: ${box.style.borderWidth} ${box.style.borderStyle} ${box.style.borderColor};\nborder-radius: ${box.style.borderRadius};`, "CSS de Borda Copiado!"); 
        }

        // --- DYNAMIC STYLE HANDLER (Scroll + Menu + Transform + Typo) ---
        function updateDynamicStyles() {
            // Scrollbar inputs
            const sWidth = document.getElementById('scroll-width').value;
            const sRadius = document.getElementById('scroll-radius').value;
            const sThumb = document.getElementById('scroll-thumb').value;
            const sTrack = document.getElementById('scroll-track').value;

            // Menu inputs
            const mBg = document.getElementById('menu-bg').value;
            const mText = document.getElementById('menu-text').value;
            const mHoverBg = document.getElementById('menu-hover-bg').value;
            const mHoverText = document.getElementById('menu-hover-text').value;
            const mBorder = document.getElementById('menu-border-col').value;
            const mRadius = document.getElementById('menu-radius').value;
            const mShadow = document.getElementById('menu-shadow-check').checked;
            const shadowCSS = mShadow ? '0 4px 12px rgba(0,0,0,0.15)' : 'none';

            // Transform inputs
            const tRotate = document.getElementById('trans-rotate').value;
            const tScale = document.getElementById('trans-scale').value;
            const tX = document.getElementById('trans-x').value;
            const tY = document.getElementById('trans-y').value;
            const tSkew = document.getElementById('trans-skew').value;
            const tDur = document.getElementById('trans-dur').value;
            const tTiming = document.getElementById('trans-timing').value;

            const styleEl = document.getElementById('dynamic-styles');
            styleEl.innerHTML = `
                /* SCROLLBAR */
                #scrollbar-target::-webkit-scrollbar { width: ${sWidth}px; }
                #scrollbar-target::-webkit-scrollbar-track { background: ${sTrack}; }
                #scrollbar-target::-webkit-scrollbar-thumb { background-color: ${sThumb}; border-radius: ${sRadius}px; border: 3px solid ${sTrack}; }
                #scrollbar-target::-webkit-scrollbar-thumb:hover { background-color: ${adjustColor(sThumb, -20)}; }

                /* CONTEXT MENU */
                .context-menu-base {
                    background-color: ${mBg} !important;
                    color: ${mText} !important;
                    border: 1px solid ${mBorder} !important;
                    border-radius: ${mRadius}px !important;
                    box-shadow: ${shadowCSS} !important;
                }
                .context-menu-base .context-item:hover {
                    background-color: ${mHoverBg} !important;
                    color: ${mHoverText} !important;
                }
                .context-menu-base .context-divider {
                    background-color: ${mBorder} !important;
                }

                /* TRANSFORM PREVIEW */
                #transform-box {
                    transition: transform ${tDur}s ${tTiming};
                }
                .transform-box-wrapper:hover #transform-box {
                    transform: rotate(${tRotate}deg) scale(${tScale}) translate(${tX}px, ${tY}px) skew(${tSkew}deg);
                }
            `;
        }

        // --- TYPOGRAPHY LOGIC ---
        function updateTypographyUI() {
            const h1Font = document.getElementById('typo-font-h1').value;
            const h1Size = document.getElementById('typo-size-h1').value;
            const h1Weight = document.getElementById('typo-weight-h1').value;
            const h1Space = document.getElementById('typo-space-h1').value;
            
            const pFont = document.getElementById('typo-font-p').value;
            const pSize = document.getElementById('typo-size-p').value;
            const pLine = document.getElementById('typo-line-p').value;

            // Labels
            document.getElementById('typo-size-h1-val').innerText = h1Size + 'px';
            document.getElementById('typo-weight-h1-val').innerText = h1Weight;
            document.getElementById('typo-space-h1-val').innerText = h1Space + 'px';
            document.getElementById('typo-size-p-val').innerText = pSize + 'px';
            document.getElementById('typo-line-p-val').innerText = pLine;

            // Apply
            const h1 = document.getElementById('typo-h1');
            const p = document.getElementById('typo-p');

            h1.style.fontFamily = h1Font.includes('sans') ? 'Inter, sans-serif' : (h1Font.includes('serif') ? 'Merriweather, serif' : 'monospace');
            if(h1Font.includes('Arial')) h1.style.fontFamily = 'Arial, sans-serif';
            if(h1Font.includes('Times')) h1.style.fontFamily = 'Times New Roman, serif';
            h1.style.fontSize = h1Size + 'px';
            h1.style.fontWeight = h1Weight;
            h1.style.letterSpacing = h1Space + 'px';

            p.style.fontFamily = pFont.includes('sans') ? 'Inter, sans-serif' : (pFont.includes('serif') ? 'Merriweather, serif' : 'monospace');
            if(pFont.includes('Arial')) p.style.fontFamily = 'Arial, sans-serif';
            p.style.fontSize = pSize + 'px';
            p.style.lineHeight = pLine;
        }

        function copyTypographyCSS() {
             const h1Font = document.getElementById('typo-font-h1').value;
             const css = `
/* Typography */
h1 {
    font-family: ${h1Font.split(',')[0]};
    font-size: ${document.getElementById('typo-size-h1').value}px;
    font-weight: ${document.getElementById('typo-weight-h1').value};
    letter-spacing: ${document.getElementById('typo-space-h1').value}px;
}
p {
    font-family: ${document.getElementById('typo-font-p').value.split(',')[0]};
    font-size: ${document.getElementById('typo-size-p').value}px;
    line-height: ${document.getElementById('typo-line-p').value};
}
             `.trim();
             copyToClipboard(css, "CSS de Tipografia Copiado!");
        }

        // --- TRANSFORM LOGIC ---
        function updateTransformUI() {
             // Values are pulled in updateDynamicStyles() and applied to CSS directly to handle hover state
             document.getElementById('trans-dur-val').innerText = document.getElementById('trans-dur').value + 's';
             updateDynamicStyles();
        }

        function copyTransformCSS() {
            const tRotate = document.getElementById('trans-rotate').value;
            const tScale = document.getElementById('trans-scale').value;
            const tX = document.getElementById('trans-x').value;
            const tY = document.getElementById('trans-y').value;
            const tSkew = document.getElementById('trans-skew').value;
            const tDur = document.getElementById('trans-dur').value;
            const tTiming = document.getElementById('trans-timing').value;
            
            const css = `
.element {
    transition: transform ${tDur}s ${tTiming};
}
.element:hover {
    transform: rotate(${tRotate}deg) scale(${tScale}) translate(${tX}px, ${tY}px) skew(${tSkew}deg);
}
            `.trim();
            copyToClipboard(css, "CSS de Transform Copiado!");
        }


        // --- SCROLLBAR LOGIC ---
        function updateScrollbarUI() {
            document.getElementById('scroll-width-val').innerText = document.getElementById('scroll-width').value + 'px';
            document.getElementById('scroll-radius-val').innerText = document.getElementById('scroll-radius').value + 'px';
            document.getElementById('scroll-thumb-hex').innerText = document.getElementById('scroll-thumb').value.toUpperCase();
            document.getElementById('scroll-thumb-dot').style.background = document.getElementById('scroll-thumb').value;
            document.getElementById('scroll-track-hex').innerText = document.getElementById('scroll-track').value.toUpperCase();
            document.getElementById('scroll-track-dot').style.background = document.getElementById('scroll-track').value;
            updateDynamicStyles();
        }
        function copyScrollbarCSS() {
            const sWidth = document.getElementById('scroll-width').value;
            const sRadius = document.getElementById('scroll-radius').value;
            const sThumb = document.getElementById('scroll-thumb').value;
            const sTrack = document.getElementById('scroll-track').value;
            const css = `/* Webkit Scrollbar */\n::-webkit-scrollbar { width: ${sWidth}px; }\n::-webkit-scrollbar-track { background: ${sTrack}; }\n::-webkit-scrollbar-thumb { background: ${sThumb}; border-radius: ${sRadius}px; }`;
            copyToClipboard(css, "CSS de Scrollbar Copiado!");
            document.getElementById('custom-context-menu').style.display = 'none';
        }

        // --- MENU LOGIC ---
        function updateMenuUI() {
            document.getElementById('menu-bg-dot').style.background = document.getElementById('menu-bg').value;
            document.getElementById('menu-text-dot').style.background = document.getElementById('menu-text').value;
            document.getElementById('menu-hover-bg-dot').style.background = document.getElementById('menu-hover-bg').value;
            document.getElementById('menu-hover-text-dot').style.background = document.getElementById('menu-hover-text').value;
            document.getElementById('menu-border-col-dot').style.background = document.getElementById('menu-border-col').value;
            document.getElementById('menu-radius-val').innerText = document.getElementById('menu-radius').value + 'px';
            updateDynamicStyles();
        }

        function copyMenuCSS() {
            const mBg = document.getElementById('menu-bg').value;
            const mText = document.getElementById('menu-text').value;
            const mHoverBg = document.getElementById('menu-hover-bg').value;
            const mHoverText = document.getElementById('menu-hover-text').value;
            const mBorder = document.getElementById('menu-border-col').value;
            const mRadius = document.getElementById('menu-radius').value;
            const mShadow = document.getElementById('menu-shadow-check').checked;
            const css = `
.context-menu {
    background-color: ${mBg};
    color: ${mText};
    border: 1px solid ${mBorder};
    border-radius: ${mRadius}px;
    box-shadow: ${mShadow ? '0 4px 12px rgba(0,0,0,0.15)' : 'none'};
    display: flex; flex-direction: column; padding: 8px 0;
}
.context-menu .item { padding: 8px 16px; cursor: pointer; }
.context-menu .item:hover { background-color: ${mHoverBg}; color: ${mHoverText}; }
            `.trim();
            copyToClipboard(css, "CSS de Menu Copiado!");
        }

        // --- SCROLLBAR CONTEXT MENU EVENT ---
        const contextMenu = document.getElementById('custom-context-menu');
        const scrollTarget = document.getElementById('scrollbar-target');
        scrollTarget.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            contextMenu.style.left = `${e.pageX}px`;
            contextMenu.style.top = `${e.pageY}px`;
            contextMenu.style.display = 'flex';
        });
        document.addEventListener('click', (e) => { if (!contextMenu.contains(e.target)) contextMenu.style.display = 'none'; });

        function adjustColor(hex, amount) {
            let usePound = false; if (hex[0] == "#") { hex = hex.slice(1); usePound = true; }
            let num = parseInt(hex, 16);
            let r = (num >> 16) + amount; if (r > 255) r = 255; else if (r < 0) r = 0;
            let b = ((num >> 8) & 0x00FF) + amount; if (b > 255) b = 255; else if (b < 0) b = 0;
            let g = (num & 0x0000FF) + amount; if (g > 255) g = 255; else if (g < 0) g = 0;
            return (usePound?"#":"") + (g | (b << 8) | (r << 16)).toString(16);
        }

        // --- RANDOMIZER & RESET ---
        function randomizeScrollbar() {
            document.getElementById('scroll-width').value = Math.floor(Math.random() * 20) + 6;
            document.getElementById('scroll-radius').value = Math.floor(Math.random() * 20);
            const randColor = () => HSLToHex(Math.random()*360, 70, 50);
            document.getElementById('scroll-thumb').value = randColor();
            updateScrollbarUI();
            document.getElementById('custom-context-menu').style.display = 'none';
        }
        function resetScrollbar() {
            document.getElementById('scroll-width').value = 12; document.getElementById('scroll-radius').value = 10;
            document.getElementById('scroll-thumb').value = "#4f46e5"; document.getElementById('scroll-track').value = "#f1f1f1";
            updateScrollbarUI();
            document.getElementById('custom-context-menu').style.display = 'none';
        }

        function closeCSSModal() { document.getElementById('css-modal').classList.remove('open'); }
        function copyCSSBlock() { copyToClipboard(document.getElementById('css-code-block').textContent, "Código Copiado!"); }
        function openAIModal() { document.getElementById('ai-modal').classList.add('open'); }
        function closeAIModal() { document.getElementById('ai-modal').classList.remove('open'); }
        function openUIModal() { document.getElementById('ui-modal').classList.add('open'); }
        function closeUIModal() { document.getElementById('ui-modal').classList.remove('open'); }
        function closeAnalysisModal() { document.getElementById('analysis-modal').classList.remove('open'); }

        // --- GRADIENT ---
        function randomGradient() {
            gradientState.c1 = HSLToHex(Math.random()*360, 80, 60); gradientState.c2 = HSLToHex(Math.random()*360, 80, 60); gradientState.angle = Math.floor(Math.random() * 360);
            updateGradientUI();
        }
        function updateGradientFromInput() {
            gradientState.c1 = document.getElementById('input-grad-1').value; gradientState.c2 = document.getElementById('input-grad-2').value; gradientState.angle = document.getElementById('grad-angle').value;
            updateGradientUI();
        }
        function updateGradientUI() {
            document.getElementById('input-grad-1').value = gradientState.c1; document.getElementById('dot-1').style.backgroundColor = gradientState.c1; document.getElementById('grad-hex-1').textContent = gradientState.c1.toUpperCase();
            document.getElementById('input-grad-2').value = gradientState.c2; document.getElementById('dot-2').style.backgroundColor = gradientState.c2; document.getElementById('grad-hex-2').textContent = gradientState.c2.toUpperCase();
            document.getElementById('grad-angle').value = gradientState.angle; document.getElementById('angle-val').textContent = gradientState.angle + '°';
            document.getElementById('gradient-preview').style.background = `linear-gradient(${gradientState.angle}deg, ${gradientState.c1}, ${gradientState.c2})`;
        }
        function copyGradientCSS() { copyToClipboard(`background: linear-gradient(${gradientState.angle}deg, ${gradientState.c1}, ${gradientState.c2});`, "CSS Copiado!"); }
        
        // --- UI GEN STUBS ---
        function generateLocalUI() {
             const type = document.getElementById('ui-component-type').value;
             const c = paletteColors; 
             const textC = c.map(hex => getLuminance(hex) > 0.5 ? '#111827' : '#FFFFFF');
             let html = "";
             if (type === 'hero') html = `<div class="w-full p-8 md:p-12 rounded-xl flex flex-col items-center text-center gap-6" style="background:${c[0]};color:${textC[0]}"><h1 class="text-4xl font-bold">Título Principal</h1><button style="background:${c[4]};color:${textC[4]}" class="px-6 py-3 rounded-lg font-bold shadow-lg">Ação</button></div>`;
             else if (type === 'card') html = `<div class="max-w-sm mx-auto rounded-2xl shadow-xl overflow-hidden" style="background:${c[0]}"><div style="height:150px;background:${c[1]}"></div><div class="p-6"><h3 style="color:${c[4]}" class="text-xl font-bold">Item</h3></div></div>`;
             document.getElementById('ui-preview-container').innerHTML = html;
        }

        function toggleVisionMenu() { document.getElementById('vision-menu').classList.toggle('open'); }
        function setVisionMode(mode) { document.body.className = mode !== 'normal' ? `filter-${mode}` : ''; document.getElementById('vision-menu').classList.remove('open'); }
        function analyzePalette() { document.getElementById('analysis-modal').classList.add('open'); document.getElementById('analysis-result').innerHTML = "<p class='text-center p-4'>Análise Básica: Cores harmoniosas geradas.</p>"; }

        // Init
        initPalette(); randomGradient(); updateShadowUI(); updateBorderUI(); updateScrollbarUI(); updateMenuUI(); updateTypographyUI(); updateTransformUI();
    </script>
</body>
</html>